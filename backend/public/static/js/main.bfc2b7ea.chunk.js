(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t,a){},,,function(e,t,a){e.exports=a.p+"static/media/slot_machine.064af86e.png"},function(e,t,a){e.exports=a.p+"static/media/machine_animate.bdcc98e5.gif"},function(e,t,a){e.exports=a.p+"static/media/jackpot.d851cc58.png"},function(e,t,a){e.exports=a.p+"static/media/nomoney.980307d7.png"},function(e,t,a){e.exports=a(21)},,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(9),o=a.n(i),l=(a(20),a(1)),s=a(2),c=a(5),u=a(3),h=a(4),m=(a(7),a(6)),d=a(10),p=a.n(d),v=a(11),f=a.n(v),g=a(12),E=a.n(g),w=a(13),b=a.n(w),y="/node/Game/",k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={workerId:a.props.workerId,assignmentId:a.props.assignmentId,showForm:!0},a.postResults=a.postResults.bind(Object(m.a)(a)),a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"postResults",value:function(){var e=this;Object.keys(this.state).length<9?alert("please fill all the questions."):fetch(y+"postAnswers",{method:"POST",body:JSON.stringify(this.state),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){"ok"==t.msg&&e.setState({showForm:!1})}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.state.showForm&&r.a.createElement("form",{id:"answers"},r.a.createElement("h1",null,"Questionarie"),r.a.createElement("label",null,r.a.createElement("span",null,"How helpful was the helper (1 - not at all, 5 - very much)?"),r.a.createElement("select",{onChange:function(t){return e.setState({q1:t.target.options[t.target.selectedIndex].value})}},r.a.createElement("option",{value:0},"-"),r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5"))),r.a.createElement("label",null,r.a.createElement("span",null,"Are you happy/satisfied with the helper (1 - not at all, 5 - very much)?"),r.a.createElement("select",{onChange:function(t){return e.setState({q2:t.target.options[t.target.selectedIndex].value})}},r.a.createElement("option",{value:0},"-"),r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5"))),r.a.createElement("label",null,r.a.createElement("span",null,"Will you be interested in using the helper again in the future (1 - not way, 5 - sure will)?"),r.a.createElement("select",{onChange:function(t){return e.setState({q3:t.target.options[t.target.selectedIndex].value})}},r.a.createElement("option",{value:0},"-"),r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5"))),r.a.createElement("label",null,r.a.createElement("span",null,"Will you recommend the helper to a friend (1 - not way, 5 - sure will)?"),r.a.createElement("select",{onChange:function(t){return e.setState({q4:t.target.options[t.target.selectedIndex].value})}},r.a.createElement("option",{value:0},"-"),r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5"))),r.a.createElement("label",null,r.a.createElement("span",null,"How much do you trust the helper (1 - absolutely don't, 5 - absolutely do)?"),r.a.createElement("select",{onChange:function(t){return e.setState({q5:t.target.options[t.target.selectedIndex].value})}},r.a.createElement("option",{value:0},"-"),r.a.createElement("option",{value:1},"1"),r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:3},"3"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:5},"5")),r.a.createElement("span",null,"Please elaborate."),r.a.createElement("textarea",{onChange:function(t){return e.setState({q6:t.target.value})}})),r.a.createElement("button",{onClick:function(t){t.preventDefault(),e.postResults()}},"Send")),!this.state.showForm&&r.a.createElement("div",null,r.a.createElement("h2",null,"Thank you for participating.")))}}]),t}(n.Component),I=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={reward:0,advice:null,msg:"",isGambling:!1,tutorial:2,end:!1,roundCounter:1},a.playRound=a.playRound.bind(Object(m.a)(a)),a.isTutorialOver=a.isTutorialOver.bind(Object(m.a)(a)),a.choices=[],a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e=this;fetch(y+"getAgentsAdvice?workerId="+this.props.workerId).then(function(e){return e.json()}).then(function(t){e.setState({advice:t.advice}),e.advice=t.advice}).catch(function(e){return console.log(e)})}},{key:"playRound",value:function(e){var t=this,a=Math.random(),n=this.props.machines[e];this.state.tutorial<=0&&this.choices.push(e),this.setState({isGambling:!0,msg:"",advice:null},function(){setTimeout(function(){a<=n?t.setState({reward:t.state.reward+1,msg:"Congratulations, you won a reward!"}):t.setState({msg:"Sorry, didn't get a reward."})},2e3)})}},{key:"isTutorialOver",value:function(){0==this.state.tutorial&&this.setState({reward:0,tutorial:-1},function(){return alert("Now tutorial mode is over, the game begins!")})}},{key:"isGameOver",value:function(){var e=this,t=Math.random();this.state.roundCounter>3&&(t<=.2&&this.state.tutorial<0||this.choices.length>10)&&this.setState({end:!0},function(){e.props.postResults(e.choices,e.advice,e.state.reward)})}},{key:"render",value:function(){var e=this,t=this.props.machines,a=this.state.isGambling?"blur-filter":"";return this.state.end?r.a.createElement("div",{id:"gui"},r.a.createElement("h2",null,"The game has ended !"),r.a.createElement("h3",null,"Final reward: ",this.state.reward," Number of rounds: ",this.state.roundCounter-1),r.a.createElement("h3",null,"Please fill the questionarie below."),r.a.createElement("hr",null),r.a.createElement(k,{workerId:this.props.workerId,assignmentId:this.props.assignmentId})):r.a.createElement("div",{id:"gui"},this.state.tutorial>0&&r.a.createElement("h1",null,"Tutorial mode"),this.isTutorialOver(),r.a.createElement("div",{id:"container",className:a},r.a.createElement("ul",{id:"machines"},t.map(function(t,a){var n=e.state.advice==a?"advice":"";return r.a.createElement("li",{key:"l"+a,className:n},r.a.createElement("h2",null,"Machine ",a+1),r.a.createElement("a",{href:"#",onClick:function(t){e.playRound(a)}},r.a.createElement("img",{src:p.a,alt:"machine"})))})),r.a.createElement("h2",{className:"message"},"Your reward is: ",this.state.reward," "),this.state.tutorial<0&&r.a.createElement("h2",{className:"message"},"Current round: ",this.state.roundCounter)),this.state.isGambling&&r.a.createElement("div",{id:"animate"},!this.state.msg&&r.a.createElement("img",{src:f.a,alt:"animate"}),this.state.msg.includes("won")&&r.a.createElement("img",{src:E.a,alt:"results"}),this.state.msg.includes("Sorry")&&r.a.createElement("img",{src:b.a,alt:"results"}),r.a.createElement("h2",{className:"message"},this.state.msg," "),this.state.msg&&r.a.createElement("button",{onClick:function(){return e.setState({isGambling:!1,advice:e.advice,tutorial:e.state.tutorial-1,roundCounter:e.state.tutorial<0?e.state.roundCounter+1:e.state.roundCounter},e.isGameOver.bind(e))}},"Next")))}}]),t}(n.Component),O=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"welcome"},r.a.createElement("h1",null,"Welcome !"),r.a.createElement("p",null,"In this task you will need to repeatedly choose a slot machine out of three available. Each machine gives you a virtual dollar with some probability (different for each machine) if activated. On each turn you will pick one of the machines that will be activated. After each round we will spin a wheel to decide whether there will be one more round or otherwise terminate the task. For each virtual dollar you accumulate you will receive one real cent as a bonus."),r.a.createElement("p",null,"To assist you, there will be a helper that knows the winning probabilities of the three machines. On each round the helper will highlight the machine she believes you should choose. To be fully fair we disclose that the helper benefits from one of the machines, and every time you pick this machine (which we cannot disclose its identity) the helper will gain a cent (not at your expense)."),r.a.createElement("p",null,"In order to get you familiarized with the game, the first 2 rounds are tutorial rounds which will help you understand the game. If you win any reward during the tutorial rounds it will not be counted."),r.a.createElement("button",{onClick:function(t){return e.props.onEnd()}},"Start"))}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={currScreen:"welcome"},a}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=new URLSearchParams(window.location.search),a=t.get("workerId"),n=t.get("assignmentId"),r=t.get("hitId");this.setState({workerId:a,assignmentId:n,hitId:r,data:""}),fetch(y+"getDistributions?workerId="+a).then(function(e){return e.json()}).then(function(t){return e.setState({machines:t.machines})}).catch(function(e){return console.log(e)})}},{key:"finishTutorial",value:function(){this.setState({currScreen:"game"})}},{key:"postResults",value:function(e,t,a){var n={workerId:this.state.workerId,assignmentId:this.state.assignmentId,hitId:this.state.hitId,advice:t,choices:e,reward:a};fetch(y+"postResults",{method:"POST",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return console.log(e)}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},"welcome"==this.state.currScreen&&r.a.createElement(O,{onEnd:this.finishTutorial.bind(this)}),"game"==this.state.currScreen&&r.a.createElement(I,{assignmentId:this.state.assignmentId,postResults:this.postResults.bind(this),workerId:this.state.workerId,machines:this.state.machines}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[14,1,2]]]);
//# sourceMappingURL=main.bfc2b7ea.chunk.js.map